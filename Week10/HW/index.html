<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Function(s) HW/Demo: Snake Game!</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            position: relative;
            width: 400px;
            height: 400px;
            border: 3px solid black;
        }

        #snake-head,
        .snake-body,
        #food {
            position: absolute;
            width: 20px;
            height: 20px;
        }

        #snake-head {
            background-color: rgb(255, 0, 128);
        }

        .snake-body {
            background-color: rgba(255, 28, 142, 0.733);
        }

        #food {
            background-color: rgb(255, 215, 18);
        }
    </style>
</head>

<body>
    <div id="game-wrapper">
        <div id="game-container">
            <div id="snake-head"></div>
            <!-- Snake body segments added dynamically here -->
            <div id="food"></div>
        </div>
    </div>

    <script>
        let snake = [{ x: 10, y: 10 }];
        let food = { x: Math.floor(Math.random() * 20), y: Math.floor(Math.random() * 20) };
        let d;
        let score = 0;

        document.addEventListener("keydown", direction);

        // function 1!
        function direction(event) {
            if (event.keyCode === 37 && d !== "RIGHT") {
                d = "LEFT";
            } else if (event.keyCode === 38 && d !== "DOWN") {
                d = "UP";
            } else if (event.keyCode === 39 && d !== "LEFT") {
                d = "RIGHT";
            } else if (event.keyCode === 40 && d !== "UP") {
                d = "DOWN";
            }
        }
        // All the keycodes" https://www.freecodecamp.org/news/javascript-keycode-list-keypress-event-key-codes/

        // function 2!
        function collision(head, array) {
            for (let i = 0; i < array.length; i++) {
                if (head.x === array[i].x && head.y === array[i].y) {
                    return true;
                }
            }
            return false;
        }

        // function 3 yeeehaw!
        function draw() {
            const snakeHead = document.getElementById("snake-head");
            const gameContainer = document.getElementById("game-container");
            const foodDiv = document.getElementById("food");
            // DOM DOMDOM DOM

            snakeHead.style.left = snake[0].x * 20 + "px";
            snakeHead.style.top = snake[0].y * 20 + "px";

            // Removin' existing body segments!!!!!!!! 
            const existingSnakeSegments = document.querySelectorAll(".snake-body");
            existingSnakeSegments.forEach(segment => segment.remove());
            // basically clear before redraw

            // Creatin' new body segments
            for (let i = 1; i < snake.length; i++) {
                const snakeSegment = document.createElement("div");
                snakeSegment.className = "snake-body";
                snakeSegment.style.left = snake[i].x * 20 + "px";
                snakeSegment.style.top = snake[i].y * 20 + "px";
                gameContainer.appendChild(snakeSegment);
            }

            foodDiv.style.left = food.x * 20 + "px";
            foodDiv.style.top = food.y * 20 + "px";

            let snakeX = snake[0].x;
            let snakeY = snake[0].y;

            if (d === "LEFT") snakeX -= 1;
            if (d === "UP") snakeY -= 1;
            if (d === "RIGHT") snakeX += 1;
            if (d === "DOWN") snakeY += 1;

            if (snakeX === food.x && snakeY === food.y) {
                score++;
                food = { x: Math.floor(Math.random() * 20), y: Math.floor(Math.random() * 20) };
            } else {
                snake.pop();
            }

            let newHead = { x: snakeX, y: snakeY };

            // all of the lose condition stuff :)
            if (snakeX < 0 || snakeX >= 20 || snakeY < 0 || snakeY >= 20 || collision(newHead, snake)) {
                clearInterval(game);
                alert("Game Over! Your score: " + score);
                location.reload();
                // restarting the game
            }

            snake.unshift(newHead);
        }

        // built in function
        let game = setInterval(draw, 100);

    </script>
</body>

</html>